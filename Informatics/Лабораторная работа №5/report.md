# Лабораторная работа 5
## Введение

На GitHub создал новый репозиторий с именем practice5. В папке на компьютере сохранил его локальную копию:
```
git clone https://github.com/VladislaZyuzin/git-practice-5.git
```
```
bash
```
```
cd git-practice-5
```

![picture](png1.PNG)

Далее создаю текстовый файл в папке и добавляю в него текст. 

```
gedit example.txt
```

Завершаю эту часть, внеся изменения в репозиторий с помощью следующих команд:
```
git add example.txt
```
```
git commit -m "File added example.txt"
```
![picture](png2.PNG)

```
git push origin main
```
![picture](png3.PNG)

При введении пароля может возникнуть ошибка, указывающая на то, что GitHub перестал поддерживать аутентификацию с использованием паролей для операций, таких как push. Вместо этого следует использовать Personal Access Token (PAT). Для этого на сайте гитхаба создаём токкен с разрешением доступа к репозиторию: repo. После получения ключа, сохраняем его у себя и используем вместо пароля.

Создаём ветку и переключаемся на неё:
```
git branch feature-branch
```
```
git checkout feature-branch
```
В новую созданную ветку feature-branch добавим старый файл, в котором будет добавлен ещё текст:
```
git add example.txt
```
```
git commit -m "File added 2 example.txt"
```
```
git push origin feature-branch
```
![picture](png4.PNG)

В завершение, переключимся на основную ветку и сольём изменения из ветки feature-branch в основную ветку:
```
git checkout main
```
```
git merge feature-branch
```
```
git push origin main
```
![picture](png5.PNG)

Таким образом, изменения были успешно слиты в главную ветку.

## Работа с ветками
Создаём новый текстовый файл с базовой структурой книги:
```
touch example2.txt
```
```
gedit example2.txt
```
Скопируем ниженаписанный текст:
```
# Название книги

## Глава 1: Введение
Введение в тему книги.

## Глава 2: Основы Git
Основные понятия и команды Git.
```
Создаю новую ветку и переключаюсь на неё:
```
git checkout -b feature-login_1
```
Для внесения изменений в файл вводим команду:
```
gedit example2.txt
```
Вводим новые данные:
```
# Название книги
## Глава 1: Введение
Здесь будет введение в тему книги.

## Глава 2: Основы Git
Основные понятия и команды Git.

## Глава 3: Вход в систему
Раздел по новой функциональности входа в систему.
```
В конце завершем изменения и отправляю их в ветку на GitHub:
```
git add example2.md
```
Но тут всплывает ошибка, так как мы не создавали файл example2.md, но мы можем поменять расширения с помощью:
```
mv example2.txt example2.md
```
![picture](png6.PNG)

После успешного переноса изменений в файл с другим расширением добавляем комментарий: 
``` 
git commit -m "Добавлена глава 3: Вход в систему"
```
Если мешает неотслеживаемый файл, то его можно убрать с помощью команды:
```
rm example2.txt
```
После чего заносии наши изменения в ветку на репозитории:
```
git push origin feature-login_1
```
![picture](png7.PNG)

Вот так это будет выглядет в репозитории

![picture](png8.PNG)

## Работа с удаленным репозиторием
Переключаемся на ветку main и там вносим изменения:
```
git checkout main
```
Вносим изменения в нашем файле с помощью:
```
gedit example2.md
```
Вносим в текстовый редактор:
```
# Название книги: Приключения в мире Git

## Глава 1: Введение
Здесь будет введение в удивительный мир Git.

## Глава 2: Основы Git
Основные понятия и команды Git.
```
Закоммитим изменения и отправим всё на GitHub:
```
git add example2.md
```
```
git commit -m "Изменено название книги и введение"
```
```
git push origin main
```
![picture](png9.PNG)

Так оно будет выглядеть в репозитории:

![picture](png10.PNG)

## Моделирование конфликта
Возвращаемся в ветку "feature-login" и вносим изменения в том же участке:
```
git switch feature-login_1
```
Меняем главу 2 в файле:
```
# Название книги: Приключения в мире Git

## Глава 1: Введение
Здесь будет введение в удивительный мир Git.

## Глава 2: Основы Git и магия конфликтов
Основные понятия и команды Git, а также волшебство разрешения конфликтов.
```
Делаем коммит изменений и отправляем на GitHub:
```
git add example2.md
```
```
git commit -m "Добавлен раздел о магии конфликтов"
```
```
git push origin feature-login
```
![picture](png11.PNG)

Репозиторий:

![picture](png12.PNG)

## Разрешение конфликта
Вернёмся в основную ветку и попробуем слить изменения:
```
git checkout main
```

![picture](png13.PNG)

```
git merge feature-login
```

Возникает конфликт:

![picture](png14.PNG)

А в самом файле появляется вот такой текст:

```
# Название книги: Приключения в мире Git

## Глава 1: Введение
Здесь будет введение в удивительный мир Git.

<<<<<<< HEAD
## Глава 2: Основы Git и магия конфликтов
Основные понятия и команды Git, а также волшебство разрешения конфликтов.
======= 
## Глава 2: Основы Git
Основные понятия и команды Git. 
>>>>>>> feature-login
```

Разрешаем конфликт, удалив метки и оставив нужные изменения:
```
# Название книги: Приключения в мире Git

## Глава 1: Введение
Здесь будет введение в удивительный мир Git.

## Глава 2: Основы Git и магия конфликтов
Основные понятия и команды Git, а также волшебство разрешения конфликтов.
```
Закоммитим разрешение конфликта и отправляем изменения на GitHub:
```
git add example2.md
```
```
git commit -m "Resolved conflict in chapter 2"
```
```
git push origin main
```
![picture](png15.PNG)

![picture](png16.1.PNG)

![picture](png16.PNG)

## Автоматизация проверки файлов при коммите
Поставлена задача: перед каждым коммитом необходимо автоматически проверять, 
чтобы все .txt файлы в репозитории соответствовали определенному формату.

В таком случае пускай сами проверяемые файлы будут книгами в формате .txt, 
а соответствие наших файлов искомым будем проверять поиском подстроки "Введение", так как в каждой книге оно есть.
Поместим скрипт в папку .git/hooks в файл pre-commit. 
```
#!/bin/bash
if grep -q "Введение" ex.txt
 then echo "Этот файл - книга"
else
 echo "Этот файл не может быть книгой"
fi
```
![picture](png21.PNG)

Для проверки работы скрипта было создано два текстовых файла:
1. book1.txt со словом "Введение":

![picture](png19.PNG)

2. book2.txt без слова "Введение":

![picture](png20.PNG)

Ниже находится скрин, подтверждающий работу скрипта:

![picture](png18.PNG)

Таким образом, при каждом коммите файла происходит его проверка и высвечивается сообщение, 
говорящее о том, является ли наш файл книгой или нет.
## Использование Git Flow в проекте
Выполняем инициализацию Git Flow в корне репозитория:
```
git flow init
```
![picture](png22.PNG)

Создадим ветку для новой функциональности "task-management":
```
git flow feature start task-management
```
![picture](png23.PNG)

Создаём файл task_manager.py
Вносим изменения в код файла task_manager.py, чтобы добавить функционал управления задачами:
```
def create_task(title):
    # Логика создания задачи
    print(f"Создана новая задача: {title}")
```
Сделаю коммит для изменения по мере разработки:
```
git add task_manager.py
```

![picture](png24.PNG)

```
git commit -m "Добавлен функционал управления задачами"
```
Завершим фичу и объединим ее с основной веткой когда завершим разработку функции:
```
git flow feature finish task-management
```
![picture](png25.PNG)

Git Flow автоматически переключится на ветку develop и выполнит слияние.

Переключимся на ветку "develop" и начнём создание релиза:
```
git checkout develop
```
```
git flow release start v1.0.0
```
![picture](png26.PNG)

Обновим версию в файле version.txt:
```
echo "v1.0.0" > version.txt
git add version.txt
git commit -m "Обновлена версия для релиза v1.0.0"
```
В конце, завершаем релиз и объединяем его с двумя ветками "develop" и "main":
```
git flow release finish v1.0.0
```
Создаём файл hotfix для случаев возникновения ошибок, который будет их исправлять:
```
git flow hotfix start hotfix-1.0.1
```
![picture](png27.PNG)

Вносим изменения для исправления ошибки и коммитим эти самые изменения:
```
# Исправление ошибки
git add file_with_error.py
```
```
git commit -m "Исправлена критическая ошибка"
```
Завершаем файл hotfix и объединяем его с ветками "develop" и "main":
```
git flow hotfix finish hotfix-1.0.1
```
![picture](png28.PNG)

В конце, завершаем работу и отправляем все изменения на удаленный репозиторий:
```
git push origin develop
```
```
git push origin main
```

![picture](png29.PNG)

## Заключение
В ходе лабораторной работы были разобраны работы с ветками, удалённым репозиторием, было произведено моделирование и разрешение конфликта при слиянии, былл написан и применён скрипт для автоматизация проверки файлов при коммите и был использован Git Flow в проекте.
